Restart of English language-learning. July 2021
===============================================
* run-2 -- work with a flawed copy of tranche-1 only


Databases in the `~/data` directory
===================================

* r2-en_pairs.rdb -- just pair counts for guten-tranche-1 only.
     Above is missing 400+ files. There were some crashes.
     This DB includes MI for pairs.

* r2-mpg_parse.rdb -- MPG disjunct counts. This includes the MMT
  marginals, so it's good-to-go.


Notes
=====

Compute MI stats for  r2-en_pairs.rdb --

```
Elapsed time to load ANY-link pairs: 696 secs
Support: found num left= 113809 num right= 113865 in 344 secs
Finished left norm marginals in 426 secs
Finished right norm marginals in 382 secs
Done with wild-card count N(x,*) and N(*,y) in 817 secs
Done 110000 of 113809 outer loops in 144 secs, pairs=9351757 (5338.4 pairs/sec)
Done computing 9684723 pair MI's in 1846 secs
Finished with MI computations; this took 1.421 hours.
Summary Report for Correlation Matrix Link Grammar ANY link Word Pairs
Left type: WordNode    Right Type: WordNode    Pair Type: EvaluationLink
Rows: 113809 Columns: 113865
Size: 9684723 non-zero entries of 12958861785 possible
Fraction non-zero: 7.4734E-4 Sparsity (-log_2): 10.386
Total observations: 230004595.  Avg obs per pair: 23.749
Entropy Total: 18.029   Left: 9.8981   Right: 9.7612
Total MI: 1.6307

                 Left         Right     Avg-left     Avg-right
                 ----         -----     --------     ---------
Support (l_0)  2.1263E+4    2.4050E+4
Count   (l_1)  2.8642E+6    3.2863E+6     134.7        136.6
Length  (l_2)  3.1925E+5    3.5502E+5     15.01        14.76
RMS Count      3.1896E+5    3.5472E+5     15.00        14.75
```

----------------------------------------------------

MPG parsing ...
wall-clock time 370 minutes for 3028 files so 7 seconds/file
total of 6 hours wall-clock time.
   .. seems to be faster than pair-counting.
2304:10 CPU time.  So 47 CPU-secs/file -- total of 38 hours CPU

RAM usage: 32.3g  29.5g so this is huge.

(ListLink . 9912398)
(Connector . 214265)
(ConnectorSeq . 7350903)
(Section .  8145420)
(EvaluationLink . 9912398)
(WordNode . 130905)

(display (monitor-storage storage-node))
Connected to `rocks:///home/ubuntu/data//r2-mpg_parse.rdb`
Database contents:
  Next aid: 35666394
  Atoms/Links/Nodes a@: 35666393 l@: 35535384 n@: 130924
  Keys/Incoming/Hash k@: 38224220 i@: 85829605 h@: 0

So 35666393 Atoms = 35M Atoms, or 830 Bytes/Atom resident RAM usage.

Disk usage:
$ du -s r2-mpg_parse.rdb
4304176 r2-mpg_parse.rdb

so 124 Bytes/Atom when on disk. Wooot! (without the disjunct marginals)

-------------------------
(gc-stats)
$2 = ((gc-time-taken . 7243681057538) (heap-size . 92037120)
(heap-free-size . 75968512) (heap-total-allocated . 5581286791152)
(heap-allocated-since-gc . 2248480) (protected-objects . 46) (gc-times .
120588))

So: 60 millisec/gc  and total 7243 seconds in GC, so 2 hours flat.
out of 38 hours CPU time, so about 5% of total CPU time is in GC.

Churned through 5581 terabytes RAM in the process. Yikes! That's
1.8 terbytes per file!  Holy cow! That seems completely excessive!
WTF!  ... each file has hundreds of sentences, so that's a dozen GB
per sentence! Sure, planar parsing is a complicated algo, but really???

-------------------------
Compute disjunct marginals.
run `3-mst-parsing/compute-mst-marginals.sh.`

Elapsed time to load csets: 1008 secs
Finished left norm marginals in 3969 secs
Finished left totals in 503 secs
Finished column (left) norm averages in 2714 secs
Done storing 7350903 left-wilds in 2190 secs
Finished right norm marginals in 424 secs
Finished right totals in 10 secs
Finished row (right) norm averages in 40 secs
Done storing 110388 right-wilds in 20 secs
Finished mmt norm marginals in 1330 secs
Finished mmt totals in 7 secs
Done storing 7350903 left-wilds in 1032 secs

Summary Report for Correlation Matrix Word-Disjunct Pairs (Connector
Sets)
Left type: WordNode    Right Type: ConnectorSeq    Pair Type: Section
Wildcard: (ListLink (ctv 0 0 1.00324e+07)
  (AnyNode "cset-word")
  (AnyNode "cset-disjunct"))
Rows: 110388 Columns: 7350903
Size: 8145420 non-zero entries of 811451480364 possible
Fraction non-zero: 1.0038E-5 Sparsity (-log_2): 16.604
Total observations: 10032415.0  Avg obs per pair: 1.2317
No MI statistics are present; run compute-mi to get them.

                 Left         Right     Avg-left     Avg-right
                 ----         -----     --------     ---------
Support (l_0)  33.62        8.9559E+4
Count   (l_1)  114.7        1.2295E+5     3.413        1.373
Length  (l_2)  41.54        1140.         1.236        1.2724E-2
RMS Count      33.31        1089.         .9909        1.2156E-2

MM^T support=8145420.0     count=1151160207.0     entropy=15.815
No M^TM data present

real    221m6.395s
user    304m6.116s
sys     83m52.293s

$ du -s r2-mpg_parse.rdb
5251780 r2-mpg_parse.rdb

Rocks: initial aid=43127689 (is num atoms plus one, so...)
Average of 125 Bytes/atom

